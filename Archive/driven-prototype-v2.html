<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driven Properties - HNI Investor Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Icons as simple SVG components
        const Icon = ({ name, className = "w-5 h-5" }) => {
            const icons = {
                search: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
                heart: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
                heartFilled: <svg className={className} fill="currentColor" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
                building: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4M8 6h.01M16 6h.01M12 6h.01M12 10h.01M12 14h.01M16 10h.01M16 14h.01M8 10h.01M8 14h.01"/></svg>,
                mapPin: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
                shield: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
                trendingUp: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
                chevronRight: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>,
                arrowLeft: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7M19 12H5"/></svg>,
                check: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>,
                clock: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
                filter: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>,
                map: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>,
                list: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>,
                play: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
                layers: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>,
                x: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
                phone: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
                message: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
                calendar: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
                calculator: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="8" y2="10.01"/><line x1="12" y1="10" x2="12" y2="10.01"/><line x1="16" y1="10" x2="16" y2="10.01"/><line x1="8" y1="14" x2="8" y2="14.01"/><line x1="12" y1="14" x2="12" y2="14.01"/><line x1="16" y1="14" x2="16" y2="14.01"/><line x1="8" y1="18" x2="8" y2="18.01"/><line x1="12" y1="18" x2="12" y2="18.01"/><line x1="16" y1="18" x2="16" y2="18.01"/></svg>,
                navigation: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>,
                car: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"/><circle cx="6.5" cy="16.5" r="2.5"/><circle cx="16.5" cy="16.5" r="2.5"/></svg>,
                train: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="4" y="3" width="16" height="16" rx="2"/><path d="M4 11h16M12 3v8M8 19l-2 3M16 19l2 3M9 15h.01M15 15h.01"/></svg>,
                walking: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="5" r="2"/><path d="m9 20 3-6 3 6M6 15l3-3 2 1 3-3 2 2"/></svg>,
                bot: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="10" rx="2"/><circle cx="12" cy="5" r="2"/><path d="M12 7v4M8 16h.01M16 16h.01"/></svg>,
                maximize: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg>,
                trash: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>,
                send: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
                eye: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
                briefcase: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>,
                plane: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"/></svg>,
                shopping: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>,
                star: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
                chart: <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>,
            };
            return icons[name] || null;
        };

        // Mock Data
        const mockProjects = [
            {
                id: 1, name: "Emaar Beachfront Vista", developer: "Emaar Properties", developerProjects: 42,
                location: "Dubai Harbour", price: "AED 1.85M", priceNum: 1850000, pricePerSqft: "AED 2,150",
                roi: "8.2%", appreciation: "+12.4%", completion: "Q4 2026", progress: 65, stage: "Structure Complete",
                beds: "1-3 BR", image: "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=600&h=400&fit=crop",
                reraNo: "RERA-2024-0892", escrowBank: "Emirates NBD", verified: true, trending: true,
                lat: 25.08, lng: 55.14, has3DTour: true, hasVideo: true,
                milestones: [
                    { name: "Ground Breaking", date: "Jan 2024", completed: true },
                    { name: "Foundation Complete", date: "Apr 2024", completed: true },
                    { name: "Structure 50%", date: "Aug 2024", completed: true },
                    { name: "Structure Complete", date: "Dec 2024", completed: true },
                    { name: "MEP Installation", date: "Apr 2025", completed: false },
                    { name: "Handover", date: "Dec 2026", completed: false }
                ]
            },
            {
                id: 2, name: "Sobha One Tower", developer: "Sobha Realty", developerProjects: 28,
                location: "Sobha Hartland", price: "AED 2.4M", priceNum: 2400000, pricePerSqft: "AED 1,890",
                roi: "7.8%", appreciation: "+9.2%", completion: "Q2 2027", progress: 42, stage: "Podium Level",
                beds: "2-4 BR", image: "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=600&h=400&fit=crop",
                reraNo: "RERA-2024-1203", escrowBank: "FAB", verified: true, trending: false,
                lat: 25.185, lng: 55.31, has3DTour: true, hasVideo: true,
                milestones: [
                    { name: "Ground Breaking", date: "Mar 2024", completed: true },
                    { name: "Foundation Complete", date: "Jul 2024", completed: true },
                    { name: "Podium Level", date: "Nov 2024", completed: true },
                    { name: "Structure 50%", date: "May 2025", completed: false },
                    { name: "Handover", date: "Jun 2027", completed: false }
                ]
            },
            {
                id: 3, name: "Damac Lagoons Villas", developer: "DAMAC Properties", developerProjects: 55,
                location: "DAMAC Lagoons", price: "AED 3.1M", priceNum: 3100000, pricePerSqft: "AED 1,450",
                roi: "9.1%", appreciation: "+15.8%", completion: "Q1 2026", progress: 78, stage: "Finishing Works",
                beds: "4-5 BR Villa", image: "https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=600&h=400&fit=crop",
                reraNo: "RERA-2023-0456", escrowBank: "Dubai Islamic Bank", verified: true, trending: true,
                lat: 25.03, lng: 55.22, has3DTour: true, hasVideo: true,
                milestones: [
                    { name: "Ground Breaking", date: "Aug 2023", completed: true },
                    { name: "Structure Complete", date: "Jun 2024", completed: true },
                    { name: "MEP Installation", date: "Sep 2024", completed: true },
                    { name: "Finishing Works", date: "Dec 2024", completed: true },
                    { name: "Handover", date: "Mar 2026", completed: false }
                ]
            }
        ];

        const commonLocations = [
            { id: 'difc', name: 'DIFC', icon: 'briefcase' },
            { id: 'dxb', name: 'Dubai Airport', icon: 'plane' },
            { id: 'mall', name: 'Dubai Mall', icon: 'shopping' },
            { id: 'custom', name: 'Custom Location', icon: 'mapPin' }
        ];

        // Navigation Component
        const TopNav = ({ onNavigate, watchlistCount }) => (
            <nav className="bg-slate-900 text-white px-6 py-4 sticky top-0 z-50">
                <div className="max-w-7xl mx-auto flex items-center justify-between">
                    <div className="flex items-center gap-8">
                        <div className="text-2xl font-bold tracking-tight">
                            <span className="text-amber-400">DRIVEN</span> PROPERTIES
                        </div>
                        <div className="hidden md:flex gap-1">
                            {['Buy', 'Rent', 'Off-Plan', 'Commercial'].map(tab => (
                                <button key={tab} className={`px-4 py-2 rounded-lg transition-all ${tab === 'Off-Plan' ? 'bg-amber-500 text-slate-900 font-semibold' : 'hover:bg-slate-800'}`}>
                                    {tab}
                                </button>
                            ))}
                        </div>
                    </div>
                    <div className="flex items-center gap-4">
                        <button onClick={() => onNavigate('watchlist')} className="relative p-2 hover:bg-slate-800 rounded-lg transition-all">
                            {watchlistCount > 0 ? <Icon name="heartFilled" className="w-5 h-5 text-amber-400" /> : <Icon name="heart" className="w-5 h-5" />}
                            {watchlistCount > 0 && (
                                <span className="absolute -top-1 -right-1 bg-amber-500 text-slate-900 text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center">{watchlistCount}</span>
                            )}
                        </button>
                        <button className="bg-amber-500 text-slate-900 px-4 py-2 rounded-lg font-semibold hover:bg-amber-400 transition-all">Investor Login</button>
                    </div>
                </div>
            </nav>
        );

        // Map View Component
        const MapView = ({ projects, onSelectProject, selectedProject, watchlist, onToggleWatchlist }) => (
            <div className="relative h-[500px] bg-slate-100 rounded-xl overflow-hidden">
                <div className="absolute inset-0 bg-gradient-to-br from-blue-50 via-slate-100 to-emerald-50">
                    <svg className="absolute inset-0 w-full h-full opacity-20">
                        <defs><pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse"><path d="M 40 0 L 0 0 0 40" fill="none" stroke="#94a3b8" strokeWidth="0.5"/></pattern></defs>
                        <rect width="100%" height="100%" fill="url(#grid)" />
                    </svg>
                    <div className="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-blue-200/50 to-transparent" />
                    <div className="absolute top-1/3 left-0 right-0 h-1 bg-slate-300" />
                    <div className="absolute top-20 left-20 text-slate-400 text-xs font-medium">Dubai Marina</div>
                    <div className="absolute top-40 right-32 text-slate-400 text-xs font-medium">Downtown Dubai</div>
                    <div className="absolute bottom-40 left-1/3 text-slate-400 text-xs font-medium">DAMAC Lagoons</div>
                </div>

                {/* Price Pins */}
                {projects.map((project, i) => (
                    <button key={project.id} onClick={() => onSelectProject(project)}
                        className={`absolute transform -translate-x-1/2 transition-all ${selectedProject?.id === project.id ? 'z-20 scale-110' : 'z-10 hover:scale-105'}`}
                        style={{ left: `${20 + i * 30}%`, top: `${30 + i * 15}%` }}>
                        <div className={`px-3 py-1.5 rounded-lg font-semibold text-sm whitespace-nowrap shadow-lg ${selectedProject?.id === project.id ? 'bg-amber-500 text-slate-900' : 'bg-white text-slate-800 border border-slate-200'}`}>
                            {project.price} {project.trending && <span className="ml-1">ðŸ”¥</span>}
                        </div>
                        <div className={`w-3 h-3 rotate-45 mx-auto -mt-1.5 ${selectedProject?.id === project.id ? 'bg-amber-500' : 'bg-white border-r border-b border-slate-200'}`} />
                    </button>
                ))}

                {/* Lasso Tool */}
                <div className="absolute bottom-4 left-4 bg-white rounded-xl shadow-lg p-2 flex items-center gap-2">
                    <button className="p-2 hover:bg-slate-100 rounded-lg transition-all">
                        <svg className="w-5 h-5 text-slate-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 19l7-7 3 3-7 7-3-3z" /><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" /></svg>
                    </button>
                    <span className="text-xs text-slate-500 pr-2">Draw to search</span>
                </div>

                {/* Selected Project Popup */}
                {selectedProject && (
                    <div className="absolute bottom-4 right-4 w-80 bg-white rounded-xl shadow-xl overflow-hidden">
                        <img src={selectedProject.image} alt={selectedProject.name} className="w-full h-32 object-cover" />
                        <div className="p-4">
                            <div className="flex items-start justify-between">
                                <div>
                                    <h3 className="font-bold text-slate-800">{selectedProject.name}</h3>
                                    <p className="text-sm text-slate-500">{selectedProject.location}</p>
                                </div>
                                <button onClick={(e) => { e.stopPropagation(); onToggleWatchlist(selectedProject); }} className="p-1.5 hover:bg-slate-100 rounded-lg">
                                    {watchlist.some(w => w.id === selectedProject.id) ? <Icon name="heartFilled" className="w-5 h-5 text-red-500" /> : <Icon name="heart" className="w-5 h-5 text-slate-400" />}
                                </button>
                            </div>
                            <div className="flex items-center gap-4 mt-3">
                                <span className="font-bold text-slate-900">{selectedProject.price}</span>
                                <span className="text-emerald-600 font-semibold">{selectedProject.roi} ROI</span>
                            </div>
                            <button className="w-full mt-3 bg-slate-900 text-white py-2 rounded-lg font-medium hover:bg-slate-800">View Details</button>
                        </div>
                    </div>
                )}
            </div>
        );

        // Distance Calculator
        const DistanceCalculator = ({ project }) => {
            const [selectedLocation, setSelectedLocation] = useState(commonLocations[0]);
            const [travelMode, setTravelMode] = useState('car');
            const distances = { difc: { km: 25, car: 28, metro: 35, walk: 180 }, dxb: { km: 32, car: 35, metro: 45, walk: 240 }, mall: { km: 22, car: 25, metro: 30, walk: 160 }, custom: { km: 15, car: 20, metro: 28, walk: 120 } };
            const distance = distances[selectedLocation.id];

            return (
                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                    <h2 className="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                        <Icon name="navigation" className="w-5 h-5 text-blue-600" /> Distance Calculator
                    </h2>
                    <div className="grid grid-cols-2 gap-2 mb-4">
                        {commonLocations.map(loc => (
                            <button key={loc.id} onClick={() => setSelectedLocation(loc)}
                                className={`flex items-center gap-2 p-3 rounded-xl border transition-all ${selectedLocation.id === loc.id ? 'border-amber-500 bg-amber-50 text-amber-700' : 'border-slate-200 hover:border-slate-300'}`}>
                                <Icon name={loc.icon} className="w-4 h-4" />
                                <span className="text-sm font-medium">{loc.name}</span>
                            </button>
                        ))}
                    </div>
                    <div className="flex items-center gap-2 mb-4">
                        {[{ mode: 'car', icon: 'car', label: 'Car' }, { mode: 'metro', icon: 'train', label: 'Metro' }, { mode: 'walk', icon: 'walking', label: 'Walk' }].map(t => (
                            <button key={t.mode} onClick={() => setTravelMode(t.mode)}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${travelMode === t.mode ? 'bg-slate-900 text-white' : 'bg-slate-100 text-slate-600'}`}>
                                <Icon name={t.icon} className="w-4 h-4" /> {t.label}
                            </button>
                        ))}
                    </div>
                    <div className="bg-blue-50 rounded-xl p-4">
                        <div className="flex items-center justify-between mb-2">
                            <span className="text-slate-600">Distance</span>
                            <span className="text-xl font-bold text-slate-900">{distance.km} km</span>
                        </div>
                        <div className="flex items-center justify-between">
                            <span className="text-slate-600">Estimated Time</span>
                            <span className="text-xl font-bold text-blue-600">{distance[travelMode]} min</span>
                        </div>
                    </div>
                    <button className="w-full mt-4 flex items-center justify-center gap-2 py-3 border border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
                        <Icon name="map" className="w-4 h-4" /> View Route on Map
                    </button>
                </div>
            );
        };

        // Immersive View Modal
        const ImmersiveViewModal = ({ project, onClose, activeView }) => {
            const [currentView, setCurrentView] = useState(activeView || '3d');
            return (
                <div className="fixed inset-0 bg-black z-50 flex flex-col">
                    <div className="flex items-center justify-between p-4 bg-black/80">
                        <div className="flex items-center gap-4">
                            <button onClick={onClose} className="text-white hover:text-amber-400"><Icon name="x" className="w-6 h-6" /></button>
                            <div><h2 className="text-white font-semibold">{project.name}</h2><p className="text-slate-400 text-sm">{project.location}</p></div>
                        </div>
                        <div className="flex items-center gap-2">
                            {[{ view: '3d', icon: 'layers', label: '3D Tour' }, { view: 'video', icon: 'play', label: 'Video' }, { view: 'floorplan', icon: 'map', label: 'Floor Plan' }].map(v => (
                                <button key={v.view} onClick={() => setCurrentView(v.view)}
                                    className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${currentView === v.view ? 'bg-amber-500 text-slate-900' : 'bg-slate-800 text-white'}`}>
                                    <Icon name={v.icon} className="w-4 h-4" /> {v.label}
                                </button>
                            ))}
                        </div>
                    </div>
                    <div className="flex-1 relative">
                        {currentView === '3d' && (
                            <div className="absolute inset-0 flex items-center justify-center">
                                <img src={project.image} alt="3D Tour" className="w-full h-full object-cover opacity-80" />
                                <div className="absolute inset-0 flex items-center justify-center">
                                    <div className="text-center">
                                        <div className="w-24 h-24 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center mb-4 mx-auto cursor-pointer hover:bg-white/30">
                                            <svg className="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/></svg>
                                        </div>
                                        <p className="text-white text-lg font-medium">Drag to explore 360Â° view</p>
                                        <p className="text-slate-400 text-sm">Use mouse or touch to navigate</p>
                                    </div>
                                </div>
                                <div className="absolute bottom-8 left-1/2 transform -translate-x-1/2 flex gap-3">
                                    {['Living Room', 'Kitchen', 'Bedroom', 'Balcony'].map((room, i) => (
                                        <button key={room} className={`px-4 py-2 rounded-full text-sm font-medium transition-all ${i === 0 ? 'bg-amber-500 text-slate-900' : 'bg-white/20 text-white hover:bg-white/30'}`}>{room}</button>
                                    ))}
                                </div>
                            </div>
                        )}
                        {currentView === 'video' && (
                            <div className="absolute inset-0 flex items-center justify-center bg-black">
                                <img src={project.image} alt="Video" className="w-full h-full object-cover opacity-60" />
                                <div className="absolute inset-0 flex items-center justify-center">
                                    <button className="w-20 h-20 rounded-full bg-amber-500 flex items-center justify-center hover:bg-amber-400">
                                        <Icon name="play" className="w-8 h-8 text-slate-900 ml-1" />
                                    </button>
                                </div>
                            </div>
                        )}
                        {currentView === 'floorplan' && (
                            <div className="absolute inset-0 flex items-center justify-center bg-white p-8">
                                <div className="max-w-4xl w-full">
                                    <div className="aspect-video bg-slate-100 rounded-xl p-8 relative">
                                        <svg viewBox="0 0 400 300" className="w-full h-full">
                                            <rect x="20" y="20" width="360" height="260" fill="none" stroke="#1e293b" strokeWidth="4"/>
                                            <rect x="20" y="20" width="200" height="160" fill="#f8fafc" stroke="#cbd5e1" strokeWidth="2"/>
                                            <text x="120" y="100" textAnchor="middle" fontSize="12" fill="#64748b">Living Room</text>
                                            <rect x="220" y="20" width="160" height="100" fill="#fef3c7" stroke="#cbd5e1" strokeWidth="2"/>
                                            <text x="300" y="70" textAnchor="middle" fontSize="12" fill="#64748b">Kitchen</text>
                                            <rect x="20" y="180" width="150" height="100" fill="#dbeafe" stroke="#cbd5e1" strokeWidth="2"/>
                                            <text x="95" y="230" textAnchor="middle" fontSize="12" fill="#64748b">Bedroom</text>
                                            <rect x="250" y="120" width="130" height="160" fill="#dcfce7" stroke="#cbd5e1" strokeWidth="2"/>
                                            <text x="315" y="200" textAnchor="middle" fontSize="12" fill="#64748b">Balcony</text>
                                        </svg>
                                        <div className="absolute top-4 right-4 bg-slate-900 text-white px-4 py-2 rounded-lg">
                                            <p className="text-xs text-slate-400">Total Area</p>
                                            <p className="font-bold">75 sqm / 807 sqft</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Search Screen
        const SearchScreen = ({ onSelectProject, watchlist, onToggleWatchlist }) => {
            const [viewMode, setViewMode] = useState('list');
            const [selectedMapProject, setSelectedMapProject] = useState(null);

            return (
                <div className="min-h-screen bg-slate-50">
                    <div className="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white py-12 px-6">
                        <div className="max-w-7xl mx-auto">
                            <div className="flex items-center gap-2 text-amber-400 text-sm font-medium mb-4">
                                <Icon name="trendingUp" className="w-4 h-4" /> INVESTOR-FOCUSED DISCOVERY
                            </div>
                            <h1 className="text-4xl font-bold mb-2">Off-Plan Investment Opportunities</h1>
                            <p className="text-slate-400 text-lg mb-8">Data-driven selection for maximum ROI potential</p>
                            <div className="bg-white rounded-2xl p-2 flex items-center gap-2 max-w-4xl">
                                <div className="flex-1 flex items-center gap-3 px-4">
                                    <Icon name="search" className="w-5 h-5 text-slate-400" />
                                    <input type="text" placeholder="Search by project, developer, or area..." className="w-full py-3 outline-none text-slate-800" />
                                </div>
                                <button className="flex items-center gap-2 px-4 py-3 text-slate-600 hover:bg-slate-100 rounded-xl"><Icon name="filter" className="w-4 h-4" /> Filters</button>
                                <button className="bg-amber-500 text-slate-900 px-6 py-3 rounded-xl font-semibold hover:bg-amber-400">Search</button>
                            </div>
                            <div className="flex flex-wrap gap-3 mt-6">
                                {['High Yield (8%+)', 'Under 2M AED', 'Ready 2026', 'Payment Plan 60/40', 'Waterfront'].map(filter => (
                                    <button key={filter} className="px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-full text-sm">{filter}</button>
                                ))}
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-6 py-8">
                        <div className="flex items-center justify-between mb-6">
                            <div>
                                <h2 className="text-xl font-semibold text-slate-800">{mockProjects.length} Investment-Grade Projects</h2>
                                <p className="text-slate-500 text-sm">Sorted by highest projected yield</p>
                            </div>
                            <div className="flex items-center gap-4">
                                <div className="flex items-center bg-slate-100 rounded-lg p-1">
                                    <button onClick={() => setViewMode('list')} className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${viewMode === 'list' ? 'bg-white shadow-sm text-slate-900' : 'text-slate-500'}`}>
                                        <Icon name="list" className="w-4 h-4" /> List
                                    </button>
                                    <button onClick={() => setViewMode('map')} className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${viewMode === 'map' ? 'bg-white shadow-sm text-slate-900' : 'text-slate-500'}`}>
                                        <Icon name="map" className="w-4 h-4" /> Map
                                    </button>
                                </div>
                            </div>
                        </div>

                        {viewMode === 'map' && <div className="mb-8"><MapView projects={mockProjects} onSelectProject={setSelectedMapProject} selectedProject={selectedMapProject} watchlist={watchlist} onToggleWatchlist={onToggleWatchlist} /></div>}

                        {viewMode === 'list' && (
                            <div className="grid gap-6">
                                {mockProjects.map(project => (
                                    <div key={project.id} className="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden hover:shadow-lg transition-all">
                                        <div className="flex flex-col md:flex-row">
                                            <div className="md:w-80 relative">
                                                <img src={project.image} alt={project.name} className="w-full h-64 md:h-full object-cover" />
                                                {project.trending && (
                                                    <div className="absolute top-4 left-4 bg-amber-500 text-slate-900 px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1">
                                                        <Icon name="trendingUp" className="w-3 h-3" /> Trending
                                                    </div>
                                                )}
                                                <button onClick={(e) => { e.stopPropagation(); onToggleWatchlist(project); }} className="absolute top-4 right-4 bg-white/90 p-2 rounded-full hover:bg-white">
                                                    {watchlist.some(w => w.id === project.id) ? <Icon name="heartFilled" className="w-5 h-5 text-red-500" /> : <Icon name="heart" className="w-5 h-5 text-slate-600" />}
                                                </button>
                                                <div className="absolute bottom-4 left-4 flex gap-2">
                                                    {project.has3DTour && <span className="bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center gap-1"><Icon name="layers" className="w-3 h-3" /> 3D</span>}
                                                    {project.hasVideo && <span className="bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center gap-1"><Icon name="play" className="w-3 h-3" /> Video</span>}
                                                </div>
                                            </div>
                                            <div className="flex-1 p-6">
                                                <div className="flex items-start justify-between">
                                                    <div>
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <h3 className="text-xl font-bold text-slate-800">{project.name}</h3>
                                                            {project.verified && <span className="bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded text-xs font-medium flex items-center gap-1"><Icon name="shield" className="w-3 h-3" /> DLD Verified</span>}
                                                        </div>
                                                        <p className="text-slate-500 flex items-center gap-1"><Icon name="building" className="w-4 h-4" /> {project.developer}</p>
                                                        <p className="text-slate-500 flex items-center gap-1 mt-1"><Icon name="mapPin" className="w-4 h-4" /> {project.location}</p>
                                                    </div>
                                                    <div className="text-right">
                                                        <p className="text-2xl font-bold text-slate-800">{project.price}</p>
                                                        <p className="text-slate-500 text-sm">{project.pricePerSqft}/sqft</p>
                                                    </div>
                                                </div>
                                                <div className="grid grid-cols-4 gap-4 mt-6 p-4 bg-slate-50 rounded-xl">
                                                    <div><p className="text-slate-500 text-xs uppercase">Expected ROI</p><p className="text-xl font-bold text-emerald-600">{project.roi}</p></div>
                                                    <div><p className="text-slate-500 text-xs uppercase">Capital Growth</p><p className="text-xl font-bold text-amber-600">{project.appreciation}</p></div>
                                                    <div><p className="text-slate-500 text-xs uppercase">Completion</p><p className="text-lg font-semibold text-slate-800">{project.completion}</p></div>
                                                    <div><p className="text-slate-500 text-xs uppercase">Construction</p>
                                                        <div className="flex items-center gap-2">
                                                            <div className="flex-1 h-2 bg-slate-200 rounded-full overflow-hidden"><div className="h-full bg-emerald-500 rounded-full" style={{ width: `${project.progress}%` }} /></div>
                                                            <span className="text-sm font-semibold">{project.progress}%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div className="flex items-center justify-between mt-6">
                                                    <div className="flex items-center gap-4 text-sm text-slate-600">
                                                        <span className="flex items-center gap-1"><Icon name="building" className="w-4 h-4" /> {project.beds}</span>
                                                    </div>
                                                    <button onClick={() => onSelectProject(project)} className="flex items-center gap-2 bg-slate-900 text-white px-5 py-2.5 rounded-xl font-medium hover:bg-slate-800">
                                                        View Investment Details <Icon name="chevronRight" className="w-4 h-4" />
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Detail Screen
        const DetailScreen = ({ project, onBack, onAddToWatchlist, inWatchlist }) => {
            const [rentalIncome, setRentalIncome] = useState(120000);
            const [holdingPeriod, setHoldingPeriod] = useState(5);
            const [showImmersive, setShowImmersive] = useState(false);
            const [immersiveType, setImmersiveType] = useState('3d');

            const annualYield = ((rentalIncome / project.priceNum) * 100).toFixed(1);
            const totalReturn = (annualYield * holdingPeriod).toFixed(1);

            const openImmersive = (type) => { setImmersiveType(type); setShowImmersive(true); };

            return (
                <div className="min-h-screen bg-slate-50">
                    {showImmersive && <ImmersiveViewModal project={project} onClose={() => setShowImmersive(false)} activeView={immersiveType} />}

                    <div className="bg-white border-b border-slate-200 px-6 py-4">
                        <div className="max-w-7xl mx-auto">
                            <button onClick={onBack} className="flex items-center gap-2 text-slate-600 hover:text-slate-900"><Icon name="arrowLeft" className="w-4 h-4" /> Back to Search</button>
                        </div>
                    </div>

                    <div className="relative h-96">
                        <img src={project.image} alt={project.name} className="w-full h-full object-cover" />
                        <div className="absolute inset-0 bg-gradient-to-t from-slate-900/80 to-transparent" />
                        <div className="absolute top-4 right-4 flex gap-2">
                            {[{ type: '3d', icon: 'layers', label: '3D Tour' }, { type: 'video', icon: 'play', label: 'Video' }, { type: 'floorplan', icon: 'map', label: 'Floor Plan' }].map(v => (
                                <button key={v.type} onClick={() => openImmersive(v.type)} className="flex items-center gap-2 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg font-medium hover:bg-white">
                                    <Icon name={v.icon} className="w-4 h-4" /> {v.label}
                                </button>
                            ))}
                        </div>
                        <div className="absolute bottom-0 left-0 right-0 p-8">
                            <div className="max-w-7xl mx-auto">
                                <div className="flex items-center gap-3 mb-3">
                                    {project.verified && <span className="bg-emerald-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1"><Icon name="shield" className="w-4 h-4" /> DLD Verified</span>}
                                    {project.trending && <span className="bg-amber-500 text-slate-900 px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1"><Icon name="trendingUp" className="w-4 h-4" /> High Demand</span>}
                                </div>
                                <h1 className="text-4xl font-bold text-white mb-2">{project.name}</h1>
                                <p className="text-slate-300 text-lg">{project.location} Â· by {project.developer}</p>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-6 py-8">
                        <div className="grid md:grid-cols-3 gap-8">
                            <div className="md:col-span-2 space-y-8">
                                {/* Verification */}
                                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                                    <h2 className="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2"><Icon name="shield" className="w-5 h-5 text-emerald-600" /> Project Verification</h2>
                                    <div className="grid md:grid-cols-2 gap-4">
                                        {[{ label: 'RERA Registration', value: project.reraNo }, { label: 'Escrow Bank', value: project.escrowBank }, { label: 'Developer Track Record', value: `${project.developerProjects} Projects` }].map(item => (
                                            <div key={item.label} className="flex items-center gap-2 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2">
                                                <Icon name="check" className="w-4 h-4 text-emerald-600" />
                                                <div className="text-sm"><span className="text-slate-500">{item.label}:</span><span className="font-semibold text-slate-800 ml-1">{item.value}</span></div>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Construction Progress */}
                                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                                    <h2 className="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2"><Icon name="building" className="w-5 h-5 text-amber-600" /> Construction Progress</h2>
                                    <div className="mb-6">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-slate-600">Overall Progress</span>
                                            <span className="text-2xl font-bold text-amber-600">{project.progress}%</span>
                                        </div>
                                        <div className="h-4 bg-slate-100 rounded-full overflow-hidden">
                                            <div className="h-full bg-gradient-to-r from-amber-500 to-emerald-500 rounded-full" style={{ width: `${project.progress}%` }} />
                                        </div>
                                        <p className="text-sm text-slate-500 mt-2">Current Stage: <span className="font-semibold text-slate-700">{project.stage}</span></p>
                                    </div>
                                    <div className="relative">
                                        {project.milestones.map((m, i) => (
                                            <div key={i} className="flex items-start gap-4 pb-6 last:pb-0">
                                                <div className="relative">
                                                    <div className={`w-8 h-8 rounded-full flex items-center justify-center ${m.completed ? 'bg-emerald-500 text-white' : 'bg-slate-200 text-slate-400'}`}>
                                                        {m.completed ? <Icon name="check" className="w-5 h-5" /> : <Icon name="clock" className="w-5 h-5" />}
                                                    </div>
                                                    {i < project.milestones.length - 1 && <div className={`absolute left-4 top-8 w-0.5 h-full -ml-px ${m.completed ? 'bg-emerald-500' : 'bg-slate-200'}`} />}
                                                </div>
                                                <div className="flex-1">
                                                    <p className={`font-medium ${m.completed ? 'text-slate-800' : 'text-slate-500'}`}>{m.name}</p>
                                                    <p className="text-sm text-slate-500">{m.date}</p>
                                                </div>
                                                {m.completed && <span className="text-emerald-600 text-sm font-medium">Complete</span>}
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Distance Calculator */}
                                <DistanceCalculator project={project} />

                                {/* Market Data */}
                                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                                    <h2 className="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2"><Icon name="chart" className="w-5 h-5 text-blue-600" /> Market Analysis</h2>
                                    <div className="grid grid-cols-3 gap-4 text-center">
                                        <div className="p-4 bg-blue-50 rounded-xl"><p className="text-3xl font-bold text-blue-600">{project.appreciation}</p><p className="text-sm text-slate-600 mt-1">3-Year Growth</p></div>
                                        <div className="p-4 bg-emerald-50 rounded-xl"><p className="text-3xl font-bold text-emerald-600">{project.roi}</p><p className="text-sm text-slate-600 mt-1">Rental Yield</p></div>
                                        <div className="p-4 bg-amber-50 rounded-xl"><p className="text-3xl font-bold text-amber-600">{project.progress}%</p><p className="text-sm text-slate-600 mt-1">Construction</p></div>
                                    </div>
                                </div>
                            </div>

                            {/* Sidebar */}
                            <div className="space-y-6">
                                <div className="bg-white rounded-2xl p-6 shadow-sm border border-slate-100 sticky top-24">
                                    <div className="flex items-center justify-between mb-4">
                                        <p className="text-slate-500">Starting From</p>
                                        <button onClick={() => onAddToWatchlist(project)} className={`p-2 rounded-lg transition-all ${inWatchlist ? 'bg-red-50 text-red-500' : 'hover:bg-slate-100 text-slate-400'}`}>
                                            {inWatchlist ? <Icon name="heartFilled" className="w-5 h-5" /> : <Icon name="heart" className="w-5 h-5" />}
                                        </button>
                                    </div>
                                    <p className="text-3xl font-bold text-slate-900">{project.price}</p>
                                    <p className="text-slate-500">{project.pricePerSqft}/sqft Â· {project.beds}</p>

                                    <div className="grid grid-cols-3 gap-2 mt-4">
                                        {[{ type: '3d', icon: 'layers', label: '3D Tour' }, { type: 'video', icon: 'play', label: 'Video' }, { type: 'floorplan', icon: 'map', label: 'Floor Plan' }].map(v => (
                                            <button key={v.type} onClick={() => openImmersive(v.type)} className="flex flex-col items-center gap-1 p-3 bg-slate-50 rounded-xl hover:bg-slate-100">
                                                <Icon name={v.icon} className="w-5 h-5 text-amber-600" />
                                                <span className="text-xs text-slate-600">{v.label}</span>
                                            </button>
                                        ))}
                                    </div>

                                    <div className="mt-6 pt-6 border-t border-slate-100">
                                        <h3 className="font-semibold text-slate-800 mb-4 flex items-center gap-2"><Icon name="calculator" className="w-4 h-4 text-amber-600" /> ROI Calculator</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="text-sm text-slate-600">Expected Annual Rent (AED)</label>
                                                <input type="range" min="80000" max="200000" step="5000" value={rentalIncome} onChange={(e) => setRentalIncome(Number(e.target.value))} className="w-full mt-2 accent-amber-500" />
                                                <p className="text-right font-semibold">AED {rentalIncome.toLocaleString()}</p>
                                            </div>
                                            <div>
                                                <label className="text-sm text-slate-600">Holding Period (Years)</label>
                                                <div className="flex gap-2 mt-2">
                                                    {[3, 5, 7, 10].map(y => (
                                                        <button key={y} onClick={() => setHoldingPeriod(y)} className={`flex-1 py-2 rounded-lg text-sm font-medium ${holdingPeriod === y ? 'bg-amber-500 text-slate-900' : 'bg-slate-100 text-slate-600'}`}>{y}y</button>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                        <div className="mt-4 p-4 bg-emerald-50 rounded-xl">
                                            <div className="flex justify-between mb-2"><span className="text-slate-600">Annual Yield</span><span className="font-bold text-emerald-600">{annualYield}%</span></div>
                                            <div className="flex justify-between"><span className="text-slate-600">{holdingPeriod}-Year Return</span><span className="font-bold text-emerald-600">{totalReturn}%</span></div>
                                        </div>
                                    </div>

                                    <div className="mt-6 space-y-3">
                                        <button className="w-full bg-amber-500 text-slate-900 py-3 rounded-xl font-semibold hover:bg-amber-400 flex items-center justify-center gap-2"><Icon name="message" className="w-5 h-5" /> WhatsApp Inquiry</button>
                                        <button className="w-full bg-slate-900 text-white py-3 rounded-xl font-semibold hover:bg-slate-800 flex items-center justify-center gap-2"><Icon name="calendar" className="w-5 h-5" /> Schedule Site Visit</button>
                                        <button className="w-full border border-slate-200 text-slate-700 py-3 rounded-xl font-medium hover:bg-slate-50 flex items-center justify-center gap-2"><Icon name="phone" className="w-5 h-5" /> Call Agent</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Watchlist Screen
        const WatchlistScreen = ({ watchlist, onRemove, onBack, onViewProject }) => {
            const [selected, setSelected] = useState([]);
            const toggle = (id) => setSelected(prev => prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]);

            return (
                <div className="min-h-screen bg-slate-50">
                    <div className="bg-white border-b border-slate-200 px-6 py-4">
                        <div className="max-w-7xl mx-auto flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <button onClick={onBack} className="flex items-center gap-2 text-slate-600 hover:text-slate-900"><Icon name="arrowLeft" className="w-4 h-4" /></button>
                                <div><h1 className="text-xl font-bold text-slate-800">Investment Watchlist</h1><p className="text-slate-500 text-sm">{watchlist.length} properties saved</p></div>
                            </div>
                            {watchlist.length > 0 && (
                                <button disabled={selected.length === 0} className={`flex items-center gap-2 px-5 py-2.5 rounded-xl font-semibold ${selected.length > 0 ? 'bg-amber-500 text-slate-900 hover:bg-amber-400' : 'bg-slate-200 text-slate-400 cursor-not-allowed'}`}>
                                    <Icon name="send" className="w-4 h-4" /> Bulk Inquiry ({selected.length})
                                </button>
                            )}
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-6 py-8">
                        {watchlist.length === 0 ? (
                            <div className="text-center py-20">
                                <Icon name="heart" className="w-16 h-16 text-slate-300 mx-auto mb-4" />
                                <h2 className="text-xl font-semibold text-slate-600 mb-2">Your watchlist is empty</h2>
                                <p className="text-slate-500 mb-6">Save properties to compare and track</p>
                                <button onClick={onBack} className="bg-amber-500 text-slate-900 px-6 py-3 rounded-xl font-semibold hover:bg-amber-400">Browse Projects</button>
                            </div>
                        ) : (
                            <>
                                <div className="flex items-center justify-between mb-6">
                                    <label className="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" checked={selected.length === watchlist.length} onChange={() => setSelected(selected.length === watchlist.length ? [] : watchlist.map(p => p.id))} className="w-5 h-5 rounded border-slate-300 text-amber-500" />
                                        <span className="text-slate-600">Select all for inquiry</span>
                                    </label>
                                    <button className="text-slate-600 hover:text-slate-900 flex items-center gap-2"><Icon name="eye" className="w-4 h-4" /> Compare</button>
                                </div>

                                <div className="grid gap-4">
                                    {watchlist.map(project => (
                                        <div key={project.id} className={`bg-white rounded-xl p-4 shadow-sm border transition-all ${selected.includes(project.id) ? 'border-amber-500 ring-2 ring-amber-200' : 'border-slate-100'}`}>
                                            <div className="flex items-center gap-4">
                                                <input type="checkbox" checked={selected.includes(project.id)} onChange={() => toggle(project.id)} className="w-5 h-5 rounded border-slate-300 text-amber-500" />
                                                <img src={project.image} alt={project.name} className="w-24 h-20 object-cover rounded-lg cursor-pointer" onClick={() => onViewProject(project)} />
                                                <div className="flex-1">
                                                    <h3 className="font-semibold text-slate-800 hover:text-amber-600 cursor-pointer" onClick={() => onViewProject(project)}>{project.name}</h3>
                                                    <p className="text-sm text-slate-500">{project.location}</p>
                                                    <div className="flex items-center gap-4 mt-2">
                                                        <span className="text-lg font-bold text-slate-800">{project.price}</span>
                                                        <span className="text-emerald-600 font-semibold">{project.roi} ROI</span>
                                                    </div>
                                                </div>
                                                <button onClick={() => onRemove(project.id)} className="text-slate-400 hover:text-red-500 p-2"><Icon name="trash" className="w-4 h-4" /></button>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                <div className="mt-8 bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-6 text-white">
                                    <h3 className="font-semibold mb-4">Portfolio Summary</h3>
                                    <div className="grid grid-cols-4 gap-6">
                                        <div><p className="text-slate-400 text-sm">Total Value</p><p className="text-2xl font-bold">AED {(watchlist.reduce((s, p) => s + p.priceNum, 0) / 1000000).toFixed(1)}M</p></div>
                                        <div><p className="text-slate-400 text-sm">Avg. ROI</p><p className="text-2xl font-bold text-emerald-400">{(watchlist.reduce((s, p) => s + parseFloat(p.roi), 0) / watchlist.length).toFixed(1)}%</p></div>
                                        <div><p className="text-slate-400 text-sm">Properties</p><p className="text-2xl font-bold">{watchlist.length}</p></div>
                                        <div><p className="text-slate-400 text-sm">Earliest</p><p className="text-2xl font-bold">{watchlist[0]?.completion}</p></div>
                                    </div>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        };

        // Main App
        function App() {
            const [screen, setScreen] = useState('search');
            const [selectedProject, setSelectedProject] = useState(null);
            const [watchlist, setWatchlist] = useState([]);

            const selectProject = (p) => { setSelectedProject(p); setScreen('detail'); };
            const toggleWatchlist = (p) => setWatchlist(prev => prev.some(x => x.id === p.id) ? prev.filter(x => x.id !== p.id) : [...prev, p]);
            const removeFromWatchlist = (id) => setWatchlist(prev => prev.filter(p => p.id !== id));

            return (
                <div className="min-h-screen bg-slate-50">
                    <TopNav onNavigate={setScreen} watchlistCount={watchlist.length} />
                    {screen === 'search' && <SearchScreen onSelectProject={selectProject} watchlist={watchlist} onToggleWatchlist={toggleWatchlist} />}
                    {screen === 'detail' && selectedProject && <DetailScreen project={selectedProject} onBack={() => setScreen('search')} onAddToWatchlist={toggleWatchlist} inWatchlist={watchlist.some(p => p.id === selectedProject.id)} />}
                    {screen === 'watchlist' && <WatchlistScreen watchlist={watchlist} onRemove={removeFromWatchlist} onBack={() => setScreen('search')} onViewProject={selectProject} />}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
